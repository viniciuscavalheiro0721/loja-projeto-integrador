{% extends "pdv/base.html" %}
{% load static %}

{% block title %}Abertura PDV{% endblock %}

{% block content %}
<body>

  <div class="container justify-content-center">
      <div>
        <h2>PDV: {{pdv.id_pdv}}</h2>
        <h3>Usuario:{{user}} </h3>
        <h3>ID_CUPOM:{{cupom.codigo_cupom}}</h3>
      </div>

        <iframe id="list" name= "frame-list" src="../../pdv/caixa/itens-cupom/" height="300px" width="100%" title="Iframe Example"></iframe>
      <div>
        <form id = "pdv" method="post" >
          {% csrf_token %}
    
          <h5>
            <label for="pgto">FORMA PGTO:</label>
            <select name="pgto" id="pgto" >
              
              {% for pgto in pgtos %}
              <option value={{pgto.id}}>{{pgto.payment_type}}</option>
              {% endfor %}
             
            </select>  
            
          <div class="form-group">
            <label for="acres">ACRESCIMO</label>
            <input type="number"  name = "acres" id="acres" min="0.00">
            <label for="sub-total">SUBTOTAL</label>
            <input type="number"  name="sub-total" id = "sub-total"  min="0.00">

          </div>

          <div class="form-group">
              <label for="desc">DESCONTO</label>
              <input type="number"  name="desc" id = "desc"  min="0.00">
              <label for="total">TOTAL</label>
              <input type="number"  name="total" id = "total"  min="0.00">

          </div>
          <div class="form-group">
            <label for="codigo">CODIGO</label>
            <input  type="text" name="codigo" id = "codigo" value = "" autofocus >
          </div>
          <input type="hidden" id="btn" name="btn" value="Inserir" />
    
          </form></h5>
        </div>
          <div>
    
            <form id = "btns" method="post" >
              {% csrf_token %}
              <input type="hidden"  name="btn" value="Cancelar"/>
              <input type="button" class="btn btn-danger" name="btn" value="Cancelar" onClick="alerta()">
              <button type="button" class="btn btn-success " id="myBtn">Finalizar</button>
            </form>
          </div>
  </div>

    {% include "pdv/modal-options.html" %}
</div>

    <script>
  $(function() {
    var availableTags = [
        {% for product in products %}
            "{{product.code_int}}",
        {% endfor %}
    ];
    console.log(availableTags)
    $( "#codigo" ).autocomplete({
      source: availableTags
    });
  } );


  function alerta(){
    if (confirm("Tem certeza que deseja cancelar esse cupom?")) {
    
      $( "#btns" ).submit();
    }
        
  }

  function fechaCupom(){
    x = parseFloat(document.getElementById("pgto").value)
    pg = parseFloat(document.getElementById("valor-pg").value)
    tot = parseFloat(document.getElementById("total").value)
    

    if (x != 4){
      $( "#fecha_cpn" ).submit();

    }else if (pg < tot){
      alert("Valor pago Ã© menor que o total devido!!!")
    }else{
      $( "#fecha_cpn" ).submit();
    }

  }


 document.getElementById("pgto").value = {{cupom.codigo_pgto_id}}
 x = {{cupom.acrescimo}}
 y = {{cupom.desconto}}
 document.getElementById("acres").value = x.toFixed(2)
 document.getElementById("desc").value = y.toFixed(2)
  </script>
</body>
<script type="text/javascript" src="{% static 'js/frente.js' %}"></script>
{% endblock %}